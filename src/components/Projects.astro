---
// Importamos Image y los tipos de Astro
import { Image } from "astro:assets"; // Asegúrate de usar astro:assets si es posible
import type { CollectionEntry } from "astro:content";
import { getCollection } from "astro:content";

// Obtenemos los proyectos como ya lo hacías
const projects: CollectionEntry<"projects">[] = await getCollection("projects");
---

<section
  id="projects"
  class="min-h-screen py-16 px-8 bg-slate-900 text-slate-300"
>
  <div class="max-w-4xl mx-auto mb-12">
    <h2 class="text-4xl font-bold text-slate-100 mb-4">Proyectos</h2>
    <p class="text-lg text-slate-400">
      Mis proyectos más emocionantes y creativos. Cada proyecto es el resultado
      de mi dedicación y pasión por la programación, y estoy encantado de
      compartirlos contigo. ¡Descubre cómo transformo ideas en realidades
      digitales!
    </p>
  </div>

  <div
    class="max-w-4xl mx-auto grid grid-cols-1 md:grid-cols-2 gap-6 items-stretch"
  >
    {
      /* --- TUS PROYECTOS DE ASTRO:CONTENT --- */
      projects.map((project) => {
        // ... (Toda tu lógica de map no cambia)
        const isFullstack = !!project.data.backend;
        const tag = isFullstack ? "Fullstack" : "Frontend";
        const tagClass = isFullstack
          ? "bg-indigo-500/20 text-indigo-300"
          : "bg-emerald-500/20 text-emerald-300";
        const feTechs =
          project.data.frontend.technologies?.split(",").map((t) => t.trim()) ||
          [];
        const beTechs =
          project.data.backend?.technologies?.split(",").map((t) => t.trim()) ||
          [];
        const allTechs = [...feTechs, ...beTechs];

        return (
          <article class="p-5 md:p-6 rounded-xl bg-slate-800 shadow-lg flex flex-col h-full border border-transparent hover:border-indigo-500/30 transition-all duration-300">
            {/* ... (Todo el contenido de tu <article> no cambia) ... */}
            <span
              class={`text-xs font-semibold rounded-full px-3 py-1 self-start mb-4 ${tagClass}`}
            >
              {tag}
            </span>
            {project.data.frontend.screenshot && (
              <a
                href={project.data.frontend.demo}
                target="_blank"
                rel="noopener noreferrer"
                class="block mb-5"
              >
                <div class="rounded-lg overflow-hidden shadow-md">
                  <Image
                    src={project.data.frontend.screenshot}
                    alt={`Captura de ${project.data.title}`}
                    width={800}
                    height={450}
                    format="webp"
                    class="w-full h-auto aspect-[16/10] object-cover object-top transition-transform duration-300 hover:scale-105"
                    loading="lazy"
                  />
                </div>
              </a>
            )}
            <header>
              <h3 class="text-2xl font-bold text-slate-100 mb-3">
                {project.data.title}
              </h3>
            </header>
            <p class="text-slate-300 text-sm mb-6 flex-grow">
              {project.data.description}
            </p>
            <footer class="flex flex-wrap gap-2">
              {allTechs.map((tech) => (
                <span class="text-xs bg-slate-700 text-slate-300 px-3 py-1 rounded-md font-medium">
                  {tech}
                </span>
              ))}
            </footer>
          </article>
        );
      })
    }

    <a
      href="https://github.com/SergioIzq"
      target="_blank"
      rel="noopener noreferrer"
      class="p-5 md:p-6 rounded-xl bg-slate-800 shadow-lg flex flex-col h-full 
             border border-transparent hover:border-indigo-500/30 transition-all duration-300
             justify-center items-center text-center group"
    >
      <h3
        class="text-2xl font-bold text-slate-100 group-hover:text-indigo-300 transition-colors duration-300"
      >
        Ver más proyectos
      </h3>
      <span
        class="text-slate-400 group-hover:text-indigo-300 transition-colors duration-300 mt-2 text-lg"
      >
        en GitHub &rarr;
      </span>
    </a>
    
  </div> </section>